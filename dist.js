const a0_0x5a4d93=a0_0x21b0;(function(_0x483005,_0x364ed8){const _0x19b878=a0_0x21b0,_0x17eb54=_0x483005();while(!![]){try{const _0x35b5da=parseInt(_0x19b878(0xb1))/0x1+-parseInt(_0x19b878(0xb3))/0x2*(parseInt(_0x19b878(0xc5))/0x3)+-parseInt(_0x19b878(0x7c))/0x4+-parseInt(_0x19b878(0xa0))/0x5*(-parseInt(_0x19b878(0xa8))/0x6)+parseInt(_0x19b878(0xc0))/0x7+-parseInt(_0x19b878(0xa9))/0x8+parseInt(_0x19b878(0xa4))/0x9*(-parseInt(_0x19b878(0x93))/0xa);if(_0x35b5da===_0x364ed8)break;else _0x17eb54['push'](_0x17eb54['shift']());}catch(_0x6aa3f2){_0x17eb54['push'](_0x17eb54['shift']());}}}(a0_0x592f,0x1fe37));const express=require(a0_0x5a4d93(0xc2)),multer=require(a0_0x5a4d93(0x8e)),bodyParser=require(a0_0x5a4d93(0x70)),cors=require('cors'),fs=require('fs'),WebSocket=require('ws'),{Connection,PublicKey,Keypair,LAMPORTS_PER_SOL,SystemProgram,TransactionMessage,VersionedTransaction}=require(a0_0x5a4d93(0xb4)),bip39=require(a0_0x5a4d93(0x88)),{derivePath}=require(a0_0x5a4d93(0xae)),XLSX=require(a0_0x5a4d93(0xb7)),{v4:uuidv4}=require(a0_0x5a4d93(0x79)),app=express();app['use'](cors()),app['use'](bodyParser['json']()),app[a0_0x5a4d93(0x81)](bodyParser[a0_0x5a4d93(0xaf)]({'extended':!![]}));const upload=multer({'dest':a0_0x5a4d93(0x87)}),userKeysData={},userWebSockets={};function a0_0x592f(){const _0x2984fd=['body-parser',')\x20并停止于\x20','An\x20error\x20occurred\x20during\x20execution.','compileToV0Message','status','log','key','sendTransaction','Sol\x20\x0a','uuid','New\x20WebSocket\x20connection','次交易：','126368ZtnqAI','url','info','get','readFile','use','toFixed','blockhash','writeFileSync','行至\x20','message','uploads/','bip39','server','map','/set-config','/upload','push','multer','m/44\x27/501\x27/0\x27/0\x27','generate','connection','hex','5630AEhyvg','random','params','utils','slice','single','上传失败，请选择文件。','readyState','send','join','Server\x20running\x20on\x20port\x203000','对不起，你需要先上传助记词文件！','handleUpgrade','10jLxXWu','path','SheetNames','toString','4527PPsdFn','所有执行全部完成。','body','Fail\x20-\x20error:','646158NVMoVS','135784szVfmo','设置成功。','min','transfer','close','ed25519-hd-key','urlencoded','mnemonicToSeedSync','3916VAmHas','termination_logs.txt','34VlXkOT','@solana/web3.js','confirmed','publicKey','xlsx','An\x20error\x20occurred:','unlinkSync','utf8','error','json','Success!\x20To\x20','toISOString','\x20Send\x20','1719914TEhlGA','OPEN','express','地址\x20','】-\x20第','465UNCTWc','emit','getLatestBlockhash','任务结束。','sheet_to_json','all','助记词已读取完成，可以开始执行交易。','toBase58','sign','开始处理\x20','split','次交易：Success!\x20To\x20','file','https://devnet.sonic.game'];a0_0x592f=function(){return _0x2984fd;};return a0_0x592f();}let BATCH_SIZE=0x2,maxCount=0x3,maxFailures=0x1;const connect=new Connection(a0_0x5a4d93(0x6f),a0_0x5a4d93(0xb5));function shuffle(_0x4deebe){const _0x597348=a0_0x5a4d93;for(let _0x2f9892=_0x4deebe['length']-0x1;_0x2f9892>0x0;_0x2f9892--){const _0x5b96d1=Math['floor'](Math[_0x597348(0x94)]()*(_0x2f9892+0x1));[_0x4deebe[_0x2f9892],_0x4deebe[_0x5b96d1]]=[_0x4deebe[_0x5b96d1],_0x4deebe[_0x2f9892]];}return _0x4deebe;}app['post'](a0_0x5a4d93(0x8c),upload[a0_0x5a4d93(0x98)](a0_0x5a4d93(0x6e)),(_0x2e56e,_0x2bf272)=>{const _0x10502b=a0_0x5a4d93,_0x49418d=_0x2e56e[_0x10502b(0x6e)];if(!_0x49418d)return _0x2bf272[_0x10502b(0x74)](0x190)['send'](_0x10502b(0x99));const _0x4203af=uuidv4(),_0x4e61de=XLSX[_0x10502b(0x80)](_0x49418d[_0x10502b(0xa1)]),_0x235ff4=_0x4e61de['Sheets'][_0x4e61de[_0x10502b(0xa2)][0x0]];let _0x27c189=XLSX[_0x10502b(0x96)][_0x10502b(0x66)](_0x235ff4,{'header':0x1});_0x27c189=shuffle(_0x27c189),userKeysData[_0x4203af]=_0x27c189,fs[_0x10502b(0xb9)](_0x49418d['path']),_0x2bf272[_0x10502b(0xbc)]({'message':_0x10502b(0x68),'userId':_0x4203af});}),app[a0_0x5a4d93(0x7f)]('/mnemonics/:userId',(_0x1aad03,_0x3cd46f)=>{const _0x2bf248=a0_0x5a4d93,{userId:_0x47a56e}=_0x1aad03[_0x2bf248(0x95)];if(!userKeysData[_0x47a56e])return _0x3cd46f[_0x2bf248(0x74)](0x190)[_0x2bf248(0x9b)]('对不起，你需要先上传助记词文件！');const _0xbe6b=userKeysData[_0x47a56e][_0x2bf248(0x8a)](_0x214d3e=>_0x214d3e[0x0]);_0x3cd46f[_0x2bf248(0xbc)](_0xbe6b);}),app['post'](a0_0x5a4d93(0x8b),(_0x2886f5,_0x35775c)=>{const _0x20ffc7=a0_0x5a4d93,{batchSize:_0x516caf,maxTransactionCount:_0x55d8c7,maxFailureCount:_0x38bab2}=_0x2886f5[_0x20ffc7(0xa6)];BATCH_SIZE=parseInt(_0x516caf),maxCount=parseInt(_0x55d8c7),maxFailures=parseInt(_0x38bab2),_0x35775c[_0x20ffc7(0x9b)](_0x20ffc7(0xaa));});const wss=new WebSocket['Server']({'noServer':!![]});app[a0_0x5a4d93(0x7f)]('/execute/:userId',async(_0x4b66cb,_0x28c26a)=>{const _0x11319d=a0_0x5a4d93,{userId:_0x3cca0d}=_0x4b66cb[_0x11319d(0x95)];if(!userKeysData[_0x3cca0d])return _0x28c26a[_0x11319d(0x74)](0x190)['send'](_0x11319d(0x9e));const _0x2f531b=userKeysData[_0x3cca0d],_0x14f970=_0x2f531b['length'];let _0x53f43c=[],_0xcac328=[];const _0x18bedb=_0x47d563=>{const _0x293242=_0x11319d;userWebSockets[_0x3cca0d]&&userWebSockets[_0x3cca0d][_0x293242(0x9a)]===WebSocket[_0x293242(0xc1)]&&userWebSockets[_0x3cca0d][_0x293242(0x9b)](_0x47d563);};let _0xe854d=async _0x1c797a=>{const _0x5aa10b=_0x11319d;let _0x15aab7=0x0,_0x525c4b=0x0;while(_0x15aab7<maxCount&&_0x525c4b<maxFailures){let {success:_0x2bf54e,result:_0x3539ff,error:_0x2f2f1a,log:_0x3febac}=await toTransaction(_0x1c797a,_0x15aab7);_0xcac328[_0x5aa10b(0x8d)](_0x3febac),_0x18bedb(_0x3febac);!_0x2bf54e?_0x525c4b++:_0x15aab7++;let _0x156a56=0x1388+Math[_0x5aa10b(0x94)]()*0x1388;await new Promise(_0x38678d=>setTimeout(_0x38678d,_0x156a56));}if(_0x525c4b>=maxFailures){const _0x147ebd=_0x5aa10b(0xc3)+_0x1c797a[_0x5aa10b(0xb6)][_0x5aa10b(0x69)]()+'\x20达到最大失败次数\x20('+maxFailures+_0x5aa10b(0x71)+new Date()[_0x5aa10b(0xbe)]()+'\x0a';_0x53f43c[_0x5aa10b(0x8d)](_0x147ebd),console[_0x5aa10b(0x75)](_0x147ebd),_0x18bedb(_0x147ebd);}};async function _0x3a1f90(_0x362f02,_0x4ba967){const _0x3e3390=_0x11319d,_0x31d03e=_0x2f531b[_0x3e3390(0x97)](_0x362f02,_0x4ba967),_0x11e7c6=_0x31d03e[_0x3e3390(0x8a)](async _0x3fcd87=>{const _0x2d1a7c=_0x3e3390,_0x2e693a=_0x3fcd87[0x0],_0x5b4e26=bip39[_0x2d1a7c(0xb0)](_0x2e693a),_0x3b2eb=derivePath(_0x2d1a7c(0x8f),_0x5b4e26['toString'](_0x2d1a7c(0x92)))[_0x2d1a7c(0x76)],_0x343d8e=Keypair['fromSeed'](_0x3b2eb),_0x2fbb35=0xfa0+Math[_0x2d1a7c(0x94)]()*0x2710;return await new Promise(_0x4b79d1=>setTimeout(_0x4b79d1,_0x2fbb35)),_0xe854d(_0x343d8e);});await Promise[_0x3e3390(0x67)](_0x11e7c6);}async function _0x2449d4(){const _0x625936=_0x11319d;for(let _0x158835=0x0;_0x158835<_0x14f970;_0x158835+=BATCH_SIZE){const _0x56d983=Math[_0x625936(0xab)](_0x158835+BATCH_SIZE,_0x14f970);console[_0x625936(0x75)](_0x625936(0x6b)+_0x158835+_0x625936(0x85)+_0x56d983+'行'),_0x18bedb('开始处理\x20'+_0x158835+_0x625936(0x85)+_0x56d983+'行'),await _0x3a1f90(_0x158835,_0x56d983);}console['log'](_0x625936(0xa5)),_0x18bedb(_0x625936(0xa5)),_0x53f43c['length']>0x0&&(console[_0x625936(0xbb)]('Terminations:',_0x53f43c),fs[_0x625936(0x84)](_0x625936(0xb2),_0x53f43c[_0x625936(0x9c)](''),_0x625936(0xba)));}try{await _0x2449d4(),_0x28c26a[_0x11319d(0x9b)](_0x11319d(0xc8));}catch(_0x7648a8){console[_0x11319d(0xbb)](_0x11319d(0xb8),_0x7648a8),_0x28c26a[_0x11319d(0x74)](0x1f4)[_0x11319d(0x9b)](_0x11319d(0x72));}}),app[a0_0x5a4d93(0x89)]=app['listen'](0xbb8,()=>{const _0x5d3e6c=a0_0x5a4d93;console[_0x5d3e6c(0x75)](_0x5d3e6c(0x9d));}),wss['on'](a0_0x5a4d93(0x91),(_0x1b543c,_0x3b31cd)=>{const _0x558ef1=a0_0x5a4d93,_0x144469=_0x3b31cd[_0x558ef1(0x7d)][_0x558ef1(0x6c)]('/')[0x1];userWebSockets[_0x144469]=_0x1b543c,console[_0x558ef1(0x75)](_0x558ef1(0x7a)),_0x1b543c['on'](_0x558ef1(0x86),_0x19bbf6=>{const _0x1a8002=_0x558ef1;console[_0x1a8002(0x75)]('Received:',_0x19bbf6);}),_0x1b543c['on'](_0x558ef1(0xad),()=>{delete userWebSockets[_0x144469];});}),app[a0_0x5a4d93(0x89)]['on']('upgrade',(_0x8d45d2,_0x4ef022,_0x43ee2b)=>{const _0x1ba73d=a0_0x5a4d93;wss[_0x1ba73d(0x9f)](_0x8d45d2,_0x4ef022,_0x43ee2b,_0x185c44=>{const _0x46731f=_0x1ba73d;wss[_0x46731f(0xc6)]('connection',_0x185c44,_0x8d45d2);});});function a0_0x21b0(_0x414149,_0x578dc7){const _0x592fdb=a0_0x592f();return a0_0x21b0=function(_0x21b052,_0x3f7a40){_0x21b052=_0x21b052-0x66;let _0x2438ed=_0x592fdb[_0x21b052];return _0x2438ed;},a0_0x21b0(_0x414149,_0x578dc7);}async function toTransaction(_0x13f76c,_0x1fba2e){const _0x48d346=a0_0x5a4d93,_0xf7a509=Keypair[_0x48d346(0x90)](),_0x54789b=_0xf7a509[_0x48d346(0xb6)][_0x48d346(0xa3)]();let _0x8afea2=new PublicKey(_0x54789b),_0x1e2b9e=parseInt(0x989680*parseFloat(Math[_0x48d346(0x94)]()[_0x48d346(0x82)](0x2)));try{let _0x21ece5=SystemProgram[_0x48d346(0xac)]({'fromPubkey':_0x13f76c[_0x48d346(0xb6)],'toPubkey':_0x8afea2,'lamports':_0x1e2b9e}),_0x641209=await connect[_0x48d346(0xc7)](),_0x412a02=new TransactionMessage({'payerKey':_0x13f76c[_0x48d346(0xb6)],'recentBlockhash':_0x641209[_0x48d346(0x83)],'instructions':[_0x21ece5]})[_0x48d346(0x73)](),_0x2ac943=new VersionedTransaction(_0x412a02);_0x2ac943[_0x48d346(0x6a)]([_0x13f76c]);let _0x2bf2e9=await connect[_0x48d346(0x77)](_0x2ac943);return console[_0x48d346(0x7e)]('【'+_0x13f76c[_0x48d346(0xb6)][_0x48d346(0x69)]()+_0x48d346(0xc4)+(_0x1fba2e+0x1)+_0x48d346(0x7b)),console[_0x48d346(0x75)](_0x48d346(0xbd)+_0x54789b+_0x48d346(0xbf)+_0x1e2b9e/LAMPORTS_PER_SOL+_0x48d346(0x78)),{'success':!![],'result':_0x2bf2e9,'log':'【'+_0x13f76c[_0x48d346(0xb6)][_0x48d346(0x69)]()+_0x48d346(0xc4)+(_0x1fba2e+0x1)+_0x48d346(0x6d)+_0x54789b+_0x48d346(0xbf)+_0x1e2b9e/LAMPORTS_PER_SOL+_0x48d346(0x78)};}catch(_0x7661c9){return console['info']('【'+_0x13f76c[_0x48d346(0xb6)][_0x48d346(0x69)]()+_0x48d346(0xc4)+(_0x1fba2e+0x1)+_0x48d346(0x7b)),console[_0x48d346(0x75)](_0x48d346(0xa7),_0x7661c9['message'],'\x0a'),{'success':![],'error':_0x7661c9[_0x48d346(0x86)],'log':'【'+_0x13f76c[_0x48d346(0xb6)][_0x48d346(0x69)]()+_0x48d346(0xc4)+(_0x1fba2e+0x1)+'次交易：Fail\x20-\x20error:'+_0x7661c9[_0x48d346(0x86)]+'\x20\x0a'};}}